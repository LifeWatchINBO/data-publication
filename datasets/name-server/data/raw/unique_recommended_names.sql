SELECT 
	NS.RECOMMENDED_SCIENTIFIC_NAME as 'recommended nameserver scientific name'
	, NS.INBO_TAXON_VERSION_KEY_FOR_RECOMMENDED_NAME


FROM [dbo].SURVEY S 
	INNER JOIN [dbo].SURVEY_EVENT SE ON S.SURVEY_KEY = SE.SURVEY_KEY 
	INNER JOIN [dbo].SAMPLE SA ON SA.SURVEY_EVENT_KEY = SE.SURVEY_EVENT_KEY 	
	INNER JOIN [dbo].TAXON_OCCURRENCE TOC ON TOC.SAMPLE_KEY = SA.SAMPLE_KEY 
	INNER JOIN [dbo].TAXON_DETERMINATION TD ON TD.TAXON_OCCURRENCE_KEY = TOC.TAXON_OCCURRENCE_KEY 
	INNER JOIN [dbo].INDEX_TAXON_NAME ITN on ITN.TAXON_LIST_ITEM_KEY = TD.TAXON_LIST_ITEM_KEY 
	INNER JOIN [dbo].TAXON_LIST_ITEM tlitd ON tlitd.TAXON_LIST_ITEM_KEY = TD.TAXON_LIST_ITEM_KEY
	INNER JOIN [inbo].NAMESERVER_12 NS ON NS.INBO_TAXON_VERSION_KEY = tlitd.TAXON_VERSION_KEY
	--INNER JOIN [dbo].NAMESERVER NSR ON NSR.INPUT_TAXON_VERSION_KEY = tlitd.TAXON_VERSION_KEY
	LEFT OUTER JOIN [dbo].TAXON_OCCURRENCE_DATA TOCD ON TOC.TAXON_OCCURRENCE_KEY = TOCD.TAXON_OCCURRENCE_KEY 
	LEFT OUTER JOIN [dbo].LOCATION L on SA.LOCATION_KEY = L.LOCATION_KEY 
	LEFT OUTER JOIN [dbo].LOCATION_NAME LN on L.LOCATION_KEY = LN.LOCATION_KEY 	

WHERE 1=1
	AND S.SURVEY_KEY IN  (  'BFN001790000000B'
				,'BFN001790000002P'
				,'BFN001790000004P'
				,'BFN001790000003G'
				,'BFN001790000004K'
				,'BFN0017900000044'
				,'BFN001790000004J'
				,'BFN001790000004C'
				,'BFN0017900000019'
				,'BFN001790000000A'
				,'BFN001790000001U'
				,'BFN0017900000006'
				,'BFN0017900000023'
				,'BFN001790000004F'
				,'BFN001790000001W'
				,'BFN001790000004I'
				,'BFN001790000003O'
				,'BFN001790000002O'
				,'BFN001790000002H'
				,'BFN001790000003C'
				,'BFN001790000003V'
				,'BFN0017900000040')

GROUP BY NS.RECOMMENDED_SCIENTIFIC_NAME, NS.INBO_TAXON_VERSION_KEY_FOR_RECOMMENDED_NAME
